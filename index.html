<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cube</title>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <audio id="audio-music-modern" src="assets/MusicModern.mp3" preload="auto" loop="true"></audio>
        
        <a-asset-item id="asset-desk-modern" src="assets/DeskModern.glb"></a-asset-item>
        <a-asset-item id="asset-bell" src="assets/DeskBell.glb"></a-asset-item>
        <a-asset-item id="asset-periph" src="assets/SourisClavier.glb"></a-asset-item>
        <a-asset-item id="asset-imac" src="assets/iMac.glb"></a-asset-item>
        <a-asset-item id="asset-stairs-modern" src="assets/StairsModern.glb"></a-asset-item>
        <a-asset-item id="asset-entrance-modern" src="assets/EntranceModern.glb"></a-asset-item>
        
        <a-asset-item id="asset-light-modern" src="assets/LightModern.glb"></a-asset-item>
      <img id="tex-mount-modern" src="assets/MountModern.png">
      <img id="tex-mount-old" src="assets/MountOld.png">
      
      </a-assets>

      <!-- Utilisation du modèle GLTF -->

      <!-- BUREAU -->

    <a-entity 
        id="le-bureau" 
        gltf-model="#asset-desk-modern" 
        position="-0.088 0.891 -7.163" 
        scale="0.04 0.04 0.05">
      </a-entity>

      <a-entity 
        id="la-sonnette" 
        gltf-model="#asset-bell" 
        position="-0.122 1.109 -5.503" 
        scale="10 10 10">
      </a-entity>


      <a-entity 
        id="periph-gauche" 
        gltf-model="#asset-periph" 
        position="-1.166 -1.692 -6.640" 
        scale="3 3 3" 
        rotation="0 180 0">
      </a-entity>
      <a-entity 
        id="imac-gauche" 
        gltf-model="#asset-imac" 
        position="-1.541 1.12 -5.828" 
        scale="0.3 0.3 0.3" 
        rotation="0 -15.65 0">
      </a-entity>

      <a-entity 
        id="periph-droit" 
        gltf-model="#asset-periph" 
        position="1.294 -1.692 -6.640" 
        scale="3 3 3" 
        rotation="0 180 0">
      </a-entity>
      <a-entity 
        id="imac-droit" 
        gltf-model="#asset-imac" 
        position="1.319 1.12 -5.828" 
        scale="0.3 0.3 0.3" 
        rotation="0 12.88 0">
      </a-entity>

      <!-- STRUCTURE -->

      <a-plane id="sol-principal" position="0 0 0" rotation="-90 0 0" width="40" height="40" color="#CCCCCC"></a-plane>
      <a-plane id="plafond" position="0 6 0" rotation="90 0 0" width="40" height="40" color="#FFF"></a-plane>

      <a-box id="mur-fond" position="0 4 -9.70" width="20" height="8" depth="0.5" color="#AAAAAA"></a-box>
      <a-box id="mur-gauche" position="-10 4 0" rotation="0 90 0" width="20" height="8" depth="0.5" color="#999"></a-box>
      <a-box id="mur-droit" position="10 4 0" rotation="0 90 0" width="20" height="8" depth="0.5" color="#999"></a-box>


      <a-entity id="escalier-droit-bas" gltf-model="#asset-stairs-modern" position="6.302 -0.08 -0.32" scale="0.32 0.25 0.25" rotation="1.03 -90 0.61"></a-entity>
      <a-entity id="escalier-droit-haut" gltf-model="#asset-stairs-modern" position="6.302 -0.10 -1.97" scale="-0.32 0.25 0.25" rotation="1.03 -90 0.61"></a-entity>
      
      <a-box id="mur-stairs-d-1" position="7.49 4 6.19" rotation="0 90 0" width="11.61" height="8" depth="3" color="#999"></a-box>
      <a-box id="mur-stairs-d-2" position="7.99 4 -6.73" rotation="0 90 0" width="8" height="8" depth="4" color="#999"></a-box>

      <a-entity id="escalier-gauche-bas" gltf-model="#asset-stairs-modern" position="-6.302 -0.10 -0.37" scale="-0.32 0.25 0.25" rotation="1.03 90 0.61"></a-entity>
      <a-entity id="escalier-gauche-haut" gltf-model="#asset-stairs-modern" position="-6.302 -0.08 -2.00" scale="0.32 0.25 0.25" rotation="1.03 90 0.61"></a-entity>
      
      <a-box id="mur-stairs-g-1" position="-7.49 4 6.19" rotation="0 90 0" width="11.61" height="8" depth="3" color="#999"></a-box>
      <a-box id="mur-stairs-g-2" position="-7.99 4 -6.73" rotation="0 90 0" width="8" height="8" depth="4" color="#999"></a-box>

<a-entity id="entrance-modern" gltf-model="assets/EntranceModern.glb" position="-6.4 0.3165 4.23841" rotation="0 90 0" scale="1 1.4 1.06"></a-entity>
      <!-- LIGHT -->
<a-entity id="light-modern" gltf-model="assets/LightModern.glb" position="-4.19 5.94218 -5" scale="0.5 0.5 0.5">
        <a-light type="point" intensity="1.5" distance="25" decay="1.5" color="#FFEECC"></a-light>
      </a-entity>
      <a-entity id="light-modern-2" gltf-model="assets/LightModern.glb" position="3.90998 5.94218 -5" scale="0.5 0.5 0.5">
        <a-light type="point" intensity="1.5" distance="25" decay="1.5" color="#FFEECC"></a-light>
      </a-entity>
      <a-entity id="light-modern-3" gltf-model="assets/LightModern.glb" position="-4.19 5.94218 7" scale="0.5 0.5 0.5">
        <a-light type="point" intensity="1.5" distance="25" decay="1.5" color="#FFEECC"></a-light>
      </a-entity>
      <a-entity id="light-modern-4" gltf-model="assets/LightModern.glb" position="3.90998 5.94218 7" scale="0.5 0.5 0.5">
        <a-light type="point" intensity="1.5" distance="25" decay="1.5" color="#FFEECC"></a-light>
      </a-entity>
      <a-entity id="light-modern-5" gltf-model="assets/LightModern.glb" position="-0.122 5.942 1" scale="1 1 1">
        <a-light type="point" intensity="2.0" distance="30" decay="1.5" color="#FFEECC"></a-light>
      </a-entity>


      <!-- Éclairage global -->
      <a-entity light="type: ambient; color: #FFF; intensity: 0.5"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 0.6" position="0 10 5"></a-entity>
      <a-entity light="type: hemisphere; color: #FFF; groundColor: #888; intensity: 0.4"></a-entity>


      <!-- DECOR EXT-->
<a-plane
        id="decor-exterieur"
        src="#tex-mount-modern"
        position="0 -20 40" 
        rotation="0 180 0"
        width="100"
        height="60"
        material="shader: flat; fog: false">
      </a-plane>

      <a-box 
        position="0 4 5" 
        width="30" height="10" depth="1" 
        color="#333" 
        side="back"
        visible="false"> </a-box>


      <!-- CAMERA -->
<a-entity id="camera-rig" position="0 1.7 -2.75">
    
    <a-entity camera look-controls wasd-controls>
        
        <a-entity 
            cursor="rayOrigin: mouse" 
            raycaster="objects: .clickable">
        </a-entity>
        
    </a-entity>
</a-entity>

      <!-- SONS -->

      <a-sound 
        id="sound-emitter" 
        src="#audio-music-modern" 
        autoplay="true" 
        loop="true" 
        positional="false" 
        volume="0.3">
      </a-sound>

    </a-scene>

<script type="module" src="/src/main.js"></script>
    <script>
      // Force le son à se lancer après l'initialisation d'A-Frame
      window.addEventListener('load', function () {
        const scene = document.querySelector("a-scene");
        if (scene.hasLoaded) {
          initSound();
        } else {
          scene.addEventListener("loaded", initSound);
        }
        
        function initSound() {
          // Débloquer le son au premier clic (requis par les navigateurs)
          document.body.addEventListener('click', function playAudio() {
            const soundEntity = document.querySelector("#sound-emitter");
            if (soundEntity && soundEntity.components && soundEntity.components.sound) {
              soundEntity.components.sound.playSound();
              console.log("Son activé");
            }
          }, { once: true });
        }
      });
    </script>
  </body>
</html>
