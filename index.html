<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cube</title>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <audio
          id="music-modern"
          src="assets/MusicModern.mp3"
          preload="auto"
          loop="true"
        ></audio>

        <a-asset-item
          id="deskmodern"
          src="assets/DeskModern.glb"
        ></a-asset-item>

        <a-asset-item id="DeskBell" src="assets/DeskBell.glb"></a-asset-item>

        <a-asset-item
          id="StairsModern"
          src="assets/StairsModern.glb"
        ></a-asset-item>
      </a-assets>

      <!-- Utilisation du modÃ¨le GLTF -->
      <a-entity
        id="le-bureau"
        gltf-model="assets/DeskModern.glb"
        position="-0.08836 0.89162 -7.44738"
        scale="0.05 0.04 0.05"
      >
      </a-entity>
      <a-entity
        id="la-sonnette"
        gltf-model="assets/DeskBell.glb"
        position="-0.12291 1.10928 -5.941"
        scale="10 10 10"
        material="color: red"
      ></a-entity>
      <a-entity
        id="StairsModern"
        gltf-model="assets/StairsModern.glb"
        position="-0.12291 1.10928 -5.941"
        scale="10 10 10"
      ></a-entity>
      <!-- Structure Hotel -->
      <a-plane
        id="sol-principal"
        position="0 0 0"
        rotation="-90 0 0"
        width="40"
        height="40"
        color="#CCCCCC"
      >
      </a-plane>

      <a-box
        id="mur-fond"
        position="0 4 -9.70982"
        width="20"
        height="8"
        depth="0.5"
        color="#AAAAAA"
      >
      </a-box>
      <a-box
        id="mur-gauche"
        position="-10 4 0"
        rotation="0 90 0"
        width="20"
        height="8"
        depth="0.5"
        color="#999"
      ></a-box>
      <a-box
        id="mur-droit"
        position="10 4 0"
        rotation="0 90 0"
        width="20"
        height="8"
        depth="0.5"
        color="#999"
      ></a-box>

      <a-plane
        position="0 8 0"
        rotation="90 0 0"
        width="40"
        height="40"
        color="#FFF"
      ></a-plane>

      <a-sky color="#ECECEC"></a-sky>

      <!-- Music Hotel -->

      <a-sound
        id="hotel-music"
        src="#music-modern"
        autoplay="true"
        loop="true"
        positional="false"
        volume="0.5"
      >
      </a-sound>
    </a-scene>

    <!-- Bouton pour dÃ©marrer la musique -->
    <div style="position: fixed; top: 20px; left: 20px; z-index: 1000">
      <button
        id="play-music"
        style="
          padding: 10px 20px;
          font-size: 16px;
          cursor: pointer;
          background: #4caf50;
          color: white;
          border: none;
          border-radius: 5px;
        "
      >
        ðŸ”Š Lancer la musique
      </button>
    </div>

    <script>
      // Forcer le lancement automatique de la musique
      document.addEventListener("DOMContentLoaded", function () {
        const scene = document.querySelector("a-scene");

        scene.addEventListener("loaded", function () {
          setTimeout(function () {
            const sound = document.querySelector("#hotel-music");
            const audioEl = document.querySelector("#music-modern");

            // Essayer de lancer avec A-Frame
            if (sound && sound.components.sound) {
              sound.components.sound.playSound();
            }

            // Essayer de lancer directement l'Ã©lÃ©ment audio HTML
            if (audioEl) {
              audioEl
                .play()
                .catch((err) => console.log("Autoplay bloquÃ©:", err));
            }

            // Cacher le bouton si Ã§a marche
            const btn = document.getElementById("play-music");
            if (audioEl && !audioEl.paused) {
              btn.style.display = "none";
            }
          }, 500);
        });
      });

      // Bouton de secours
      document
        .getElementById("play-music")
        .addEventListener("click", function () {
          const sound = document.querySelector("#hotel-music");
          const audioEl = document.querySelector("#music-modern");

          if (sound && sound.components.sound) {
            sound.components.sound.playSound();
          }
          if (audioEl) {
            audioEl.play();
          }

          this.textContent = "ðŸ”Š Musique en cours";
          this.disabled = true;
          this.style.background = "#888";
        });

      // Tenter de lancer au premier clic sur la page
      document.addEventListener(
        "click",
        function autoplay() {
          const audioEl = document.querySelector("#music-modern");
          if (audioEl && audioEl.paused) {
            audioEl.play().catch(() => {});
          }
          document.removeEventListener("click", autoplay);
        },
        { once: true },
      );
    </script>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
